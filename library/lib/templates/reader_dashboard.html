{% extends 'reader_base.html' %}

{% block content %}
<style>
  .dashboard-container { padding: 20px; max-width: 1200px; margin: 0 auto; }
  .welcome-section { margin-bottom: 30px; }
  .welcome-section h2 { color: var(--text-dark); margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
  .staff-badge { display: inline-block; background: var(--primary-blue); color: white; font-size: 0.75rem; padding: 4px 10px; border-radius: 12px; font-weight: 600; }
  .section-title { color: var(--text-dark); margin-top: 30px; margin-bottom: 15px; font-size: 18px; font-weight: 600; }
  .info-card { background: var(--card-bg); padding: 20px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid var(--primary-blue); }
  .info-item { margin: 8px 0; line-height: 1.8; }
  .table-wrapper { overflow-x: auto; }
  table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.08); margin-bottom: 20px; }
  table thead th { background: var(--primary-blue); color: white; padding: 12px; text-align: left; font-weight: 600; }
  table tbody td { padding: 12px; border-bottom: 1px solid var(--border-color); }
  table tbody tr:last-child td { border-bottom: none; }
    table tbody tr:hover { background: var(--muted-bg); }
    .not-returned { color: var(--warning-color); font-weight: 600; }
</style>

<div class="dashboard-container">
    {% if messages %}
        {% for message in messages %}
            <div class="alert {% if message.tags %}alert-{{ message.tags }}{% else %}alert-info{% endif %}">{{ message }}</div>
        {% endfor %}
    {% endif %}
    <div class="welcome-section">
        <h2 style="margin:0 0 8px 0;display:flex;align-items:center;gap:12px;">ðŸ‘‹ {{ reader.name }}
            <span class="staff-badge">{% if reader.is_staff_member %}Teacher{% else %}Student{% endif %}</span>
            <a href="{% url 'reader_profile' %}" style="margin-left:12px; font-size:0.9rem;" class="btn btn-primary">View Profile</a>
            <a href="{% url 'edit_profile' %}" style="margin-left:12px; font-size:0.9rem;" class="btn btn-secondary">Edit Profile</a>
            <a href="{% url 'change_password' %}" style="margin-left:8px; font-size:0.9rem;" class="btn btn-warning">Change Password</a>
        </h2>
    </div>

    <h3 class="section-title">ðŸ“š Your Issued Books</h3>
    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Book</th>
                    <th>Issued Date</th>
                    <th>Due Date</th>
                    <th>Returned Date</th>
                </tr>
            </thead>
            <tbody>
                {% for issue in issues %}
                <tr>
                    <td>{{ issue.book.name }}</td>
                    <td>{{ issue.issued_date }}</td>
                    <td>{{ issue.due_date }}</td>
                    <td>
                        {% if issue.returned_date %}
                            {{ issue.returned_date }}
                        {% else %}
                            <span class="not-returned">Not Returned</span>
                        {% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4" style="text-align:center;color:var(--muted-text);padding:20px;">You have no issued books.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <h3 class="section-title">ðŸ’° Your Pending Fines</h3>
    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Book</th>
                    <th>Amount</th>
                </tr>
            </thead>
            <tbody>
                {% for fine in fines %}
                <tr>
                    <td>{{ fine.issue.book.name }}</td>
                    <td>â‚¹{{ fine.amount }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="2" style="text-align:center;color:var(--muted-text);padding:20px;">No pending fines.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

{% endblock %}